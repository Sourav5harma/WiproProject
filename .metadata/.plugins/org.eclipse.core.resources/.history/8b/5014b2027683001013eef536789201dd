<%@ page contentType="text/html;charset=UTF-8" language="java"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html lang="en">
<head>
  <title>User Dashboard - WorkNest</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {margin:0;min-height:100vh;display:flex;flex-direction:column;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#f6f3fa,#ebe3f8);color:#4b4453;}
    nav{display:flex;justify-content:space-between;align-items:center;background:#a88fd8;padding:1rem 2rem;}
    nav .title{font-size:1.6rem;font-weight:700;color:white;}
    nav .actions{display:flex;gap:1rem;}
    nav .actions a{padding:.6rem 1.2rem;border-radius:30px;background:white;color:#6a4ba8;font-weight:600;text-decoration:none;}
    nav .actions a:hover{background:#d3c2f7;color:white;}
    table{width:100%;border-collapse:collapse;margin-top:1.5rem;border-radius:1rem;overflow:hidden;box-shadow:0 4px 12px rgba(168,143,216,0.25);}
    th,td{padding:1rem;text-align:left;}
    th{background:#a88fd8;color:white;}
    tr:nth-child(even){background:#f6f3fa;}
    tr:hover{background:#e9defc;}
    .btn{padding:.4rem .9rem;border:none;border-radius:.6rem;cursor:pointer;font-size:.9rem;}
    .btn-primary{background:#6a4ba8;color:white;}
    .btn-success{background:#28a745;color:white;}
    .btn-secondary{background:#6c757d;color:white;}
    .btn-link{background:transparent;color:#6a4ba8;text-decoration:underline;cursor:pointer;}
    footer{background:#a88fd8;color:white;padding:1rem;text-align:center;margin-top:auto;border-top-left-radius:1rem;border-top-right-radius:1rem;}
    .container{max-width:1000px;margin:2rem auto;padding:0 1.5rem;}
  </style>
</head>
<body>
  <nav>
    <div class="title">WorkNest</div>
    <div class="actions">
      <a href="<c:url value='/admin/login'/>">Admin</a>
      <a href="<c:url value='/user/login'/>">User</a>
    </div>
  </nav>

  <div class="container">
    <h2>Welcome, ${user.name}</h2>
    <a class="btn btn-secondary" href="<c:url value='/user/logout'/>">Logout</a>

    <h3 style="margin-top:20px;">My Tasks</h3>
    <c:if test="${empty tasks}">
      <p>No tasks assigned to you yet.</p>
    </c:if>
    <c:if test="${not empty tasks}">
      <table>
        <tr>
          <th>Title</th>
          <th>Description</th>
          <th>Status</th>
          <th>Start Date</th>
          <th>Due Date</th>
          <th>Actions</th>
        </tr>
        <c:forEach items="${tasks}" var="t">
          <tr>
            <td>${t.title}</td>
            <td>${t.description}</td>
            <td>${t.status}</td>
            <td>${t.startDate}</td>
            <td>${t.dueDate}</td>
            <td>
              <form style="display:inline;" method="post" action="<c:url value='/tasks/status/${t.taskId}'/>">
                <input type="hidden" name="status" value="IN_PROGRESS">
                <button class="btn btn-primary">In Progress</button>
              </form>
              <form style="display:inline;" method="post" action="<c:url value='/tasks/status/${t.taskId}'/>">
                <input type="hidden" name="status" value="COMPLETED">
                <button class="btn btn-success">Completed</button>
              </form>
              <a class="btn btn-link" href="<c:url value='/tasks/view/${t.slug}'/>">Open</a>
            </td>
          </tr>
        </c:forEach>
      </table>
    </c:if>
    <button type="button" class="btn btn-secondary" style="margin-top:15px;" onclick="history.back()">Back</button>
  </div>

  <footer>Â© 2025 WorkNest</footer>
</body>
</html>
